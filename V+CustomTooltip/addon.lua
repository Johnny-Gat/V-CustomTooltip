local ItemDB = {
[35]=9,[36]=7,[37]=7,[38]=1,
[40]=1,
[43]=1,[44]=1,[45]=1,
[47]=1,[48]=1,[49]=1,
[51]=1,[52]=1,[53]=1,
[55]=1,[56]=1,
[60]=12,[61]=12,
[79]=10,[80]=7,
[129]=1,
[117]=1,[118]=5,
[147]=1,[148]=1,
[159]=1,
[182]=0,
[414]=6,
[422]=25,
[710]=72,
[719]=4,
[723]=15,[724]=25,[725]=0,
[727]=244,[728]=50,[729]=17,[730]=16,[731]=27,[732]=6,[733]=100,
[735]=0,
[745]=0,
[748]=0,
[750]=0,
[752]=0,
[755]=1,
[763]=58,
[765]=10,
[768]=113,[769]=3,
[771]=38,[772]=0,[773]=0,[774]=15,
[777]=21,
[779]=18,[780]=0,
[782]=0,[783]=50,
[785]=20,
[787]=1,
[805]=250,
[814]=25,
[818]=100,
[828]=250,[829]=0,
[832]=203,
[841]=0,
[856]=875,[857]=2500,
[858]=25,
[929]=75,
[957]=0,
[961]=2,[962]=0,
[981]=0,
[983]=21,
[1006]=0,
[1010]=99,[1011]=80,
[1019]=0,
[1081]=50,
[1083]=0,
[1158]=146,[1159]=32,
[1161]=25,
[1171]=55,
[1178]=7,[1179]=6,[1180]=37,[1181]=25,
[1191]=82,
[1195]=47,
[1205]=25,
[1208]=0,
[1252]=0,
[1256]=0,[1257]=0,
[1262]=111,
[1274]=8,
[1327]=0,
[1353]=0,
[1359]=19,
[1364]=8,
[1368]=2,[1369]=4,
[1376]=4,
[1378]=1,
[1381]=0,
[1389]=58,
[1395]=1,
[1399]=12,
[1411]=68,
[1413]=55,[1414]=97,[1415]=72,[1416]=72,[1417]=65,
[1419]=19,
[1421]=28,
[1423]=18,
[1425]=37,
[1427]=29,
[1429]=7,
[1431]=20,
[1433]=14,[1434]=43,
[1468]=28,
[1475]=82,[1476]=6,
[1479]=47,
[1497]=71,[1498]=57,[1499]=51,
[1501]=80,
[1503]=109,[1504]=32,
[1507]=123,
[1509]=59,
[1511]=193,
[1514]=294,[1515]=196,[1516]=237,
[1528]=0,
[1537]=62,
[1561]=268,
[1734]=39,[1735]=89,
[1740]=97,
[1742]=129,
[1748]=232,
[1764]=113,
[1800]=479,
[1821]=988,
[1931]=0,
[2004]=0,
[2047]=25,[2048]=24,
[2066]=81,[2067]=186,
[2070]=1,
[2092]=7,
[2102]=1,
[2108]=8,
[2138]=38,
[2165]=45,
[2172]=7,
[2186]=6,[2187]=0,[2188]=0,
[2211]=7,
[2213]=24,
[2216]=210,
[2218]=501,
[2224]=24,[2225]=183,
[2238]=60,
[2251]=12,
[2260]=106,
[2266]=479,
[2281]=300,
[2284]=211,
[2287]=6,
[2318]=15,[2319]=50,
[2326]=29,
[2361]=9,
[2407]=162,[2408]=125,[2409]=350,
[2447]=10,
[2449]=20,
[2453]=25,[2454]=20,[2455]=10,
[2508]=5,
[2516]=0,
[2536]=0,
[2546]=55,[2547]=7,[2548]=0,
[2575]=25,
[2589]=13,
[2591]=5,[2592]=33,
[2598]=30,
[2601]=100,
[2619]=0,
[2628]=0,
[2640]=0,
[2642]=33,[2643]=28,[2644]=11,[2645]=11,
[2648]=58,[2649]=1,
[2652]=7,[2653]=3,
[2656]=9,[2657]=875,
[2666]=0,[2667]=0,
[2671]=0,[2672]=4,[2673]=10,
[2676]=0,[2677]=15,
[2686]=12,
[2690]=7,[2691]=10,
[2696]=0,[2697]=100,
[2722]=0,[2723]=12,
[2760]=0,
[2763]=240,
[2770]=5,[2771]=25,
[2773]=39,[2774]=28,[2775]=75,[2776]=500,
[2806]=0,
[2817]=201,
[2832]=0,
[2835]=2,
[2838]=60,
[2842]=100,
[2862]=3,
[2886]=5,
[2898]=32,
[2900]=89,
[2934]=7,
[2940]=43,
[2947]=0,
[2958]=94,[2959]=32,[2960]=21,
[2962]=120,[2963]=41,
[2966]=146,[2967]=66,[2968]=33,
[2971]=108,[2972]=72,
[2975]=128,
[2980]=209,[2981]=648,
[2984]=215,
[2990]=933,
[2996]=40,
[2998]=0,[2999]=0,
[3012]=50,[3013]=25,
[3070]=11,
[3083]=0,[3084]=0,[3085]=0,[3086]=0,
[3110]=0,
[3117]=0,
[3151]=87,[3152]=28,[3153]=33,
[3158]=60,
[3160]=470,
[3169]=18,[3170]=47,[3171]=6,[3172]=18,[3173]=15,[3174]=16,
[3183]=0,
[3189]=99,[3190]=99,
[3198]=2741,
[3200]=19,
[3214]=33,
[3216]=55,
[3220]=40, 
[3224]=28,
[3239]=3,
[3283]=295,
[3297]=0,
[3299]=48,[3300]=9,
[3310]=442,
[3355]=50,[3356]=30,[3357]=75,
[3365]=3,
[3373]=14,
[3385]=30,
[3409]=0,
[3411]=0,[3412]=0,
[3609]=25,[3610]=50,
[3627]=0,
[3652]=364,
[3661]=9,
[3679]=100,
[3770]=25,
[4232]=125,
[4238]=200,
[4296]=525,
[4346]=100,
[4359]=12,
[4363]=50,[4364]=12,
[4382]=600,
[4496]=125,
[4536]=1,[4537]=6,[4538]=25,
[4540]=1,[4541]=6,[4542]=25,
[4560]=37,
[4562]=298,[4563]=110,
[4576]=1184,
[4592]=1,[4593]=4,
[4604]=1,[4605]=6,[4606]=25,
[4656]=1,
[4658]=23,[4659]=23,[4660]=324,
[4662]=24,[4663]=23,
[4666]=26,
[4678]=108,
[4683]=92,[4684]=61,
[4689]=106,[4690]=71,
[4708]=461,
[4775]=28,[4776]=41,
[4813]=33,[4814]=6,
[4865]=5,
[5109]=223,
[5166]=0,[5167]=0,
[5184]=0,[5185]=0,[5186]=0,
[5391]=0,
[5393]=32,[5394]=6,[5395]=16,
[5398]=13,
[5457]=23,
[5465]=3,
[5503]=16,
[5523]=15,
[5571]=250,[5572]=250,[5573]=875,
[5579]=32,[5580]=25,[5581]=32,
[5619]=0,
[5621]=0,
[5639]=0,
[5761]=30,
[5998]=0,
[6058]=6,
[6070]=6,
[6076]=9,
[6078]=15,
[6096]=1,
[6098]=1,
[6117]=1,[6118]=1,
[6123]=1,[6124]=1,
[6171]=6,
[6173]=7,
[6176]=15,
[6185]=9,
[6215]=601,
[6267]=149,
[6303]=1,
[6347]=100,
[6506]=87,[6507]=44,
[6511]=121,
[6513]=28,[6514]=42,
[6517]=35,
[6519]=36,
[6521]=47,
[6538]=492,
[6554]=229,[6555]=130,
[6566]=411,
[6583]=425,
[6889]=4,
[6948]=0,
[6952]=0,
[7005]=16,
[7073]=6,[7074]=4,
[7096]=5,[7097]=1,[7098]=6,
[7100]=7,[7101]=5,
[7109]=74,
[7351]=58,
[7627]=0,
[7646]=0,
[7997]=81,
[8048]=0,
[8177]=71,[8178]=306,[8179]=28,
[8180]=240,[8181]=79,
[9548]=0,
[9555]=0,
[9563]=0,
[9566]=0,
[9570]=0,[9571]=0,
[9580]=0,
[9746]=56,
[9751]=86,[9752]=57,
[9765]=406,
[9780]=369,
[9787]=358,
[9789]=741,
[9792]=823,
[9801]=708,
[9812]=570,
[10438]=0,[10439]=0,[10440]=0,
[10550]=48,
[10639]=0,[10640]=0,[10641]=0,[10642]=0,
[10656]=14,
[11119]=0,
[11125]=0,
[11191]=45,[11192]=4,
[11287]=508,[11288]=1535,
[11406]=168,
[11475]=7,
[11967]=1087,
[12047]=4996,
[12295]=282,[12296]=722,
[13850]=0,
[13872]=0,
[14046]=5000,
[14091]=119,
[14114]=242,
[14166]=238,
[15010]=163,
[15223]=2376,
[15268]=1024,
[15477]=192,
[15486]=245,
[15908]=0,
[15911]=0,
[15913]=0,
[15925]=439,
[15932]=527,
[15969]=425,
[15998]=0,
[16115]=0,
[16310]=0,[16311]=0,
[16313]=0,[16314]=0,
[16605]=17,
[17056]=7,
[17117]=0,[17118]=0,[17119]=6,
[17735]=0,
[20558]=0,
[21100]=0,
[50001]=0,
[50002]=0,

}

local function CreateGoldString(money)
	local gold = floor(money/ 100 / 100)
	local silver = floor(mod((money/100),100))
	local copper = floor(mod(money,100))
  
	local string = ""
	if gold > 0 then string = string .. "|cffffffff" .. gold .. "|cffffd700g" end
	if silver > 0 then string = string .. "|cffffffff " .. silver .. "|cffc7c7cfs" end
	string = string .. "|cffffffff " .. copper .. "|cffeda55fc - Addon"
  
	return string
end

function AddMoneyFrame(itemLink, itemCount)
	if not itemLink then
		GameTooltip:AddLine("|nError!", 1, 0.13, 0.13)
	else
		local _, _, itemId = string.find(itemLink, "item:(%d+)") -- найти |H<слово>:<число>
		itemId = tonumber(itemId)
		if ItemDB[itemId] then
			if ItemDB[itemId] > 0 then
				if not MerchantFrame:IsShown() then -- эта проверка не для всех подсказок нужна
					GameTooltip:AddLine("|n")
					SetTooltipMoney(GameTooltip, ItemDB[itemId] * itemCount)
				else
					GameTooltip:AddLine(CreateGoldString(ItemDB[itemId] * itemCount), 1, 1, 1)
				end
			else
				GameTooltip:AddLine("|nNo sell price", 1, 1, 1)
			end
			if IsAltKeyDown() then
				GameTooltip:AddLine("|nItem ID: " .. itemId, 1, 1, 1)
			end
		else
			GameTooltip:AddLine("|nItem ID: " .. itemId, 1, 1, 1)
		end
	end
	GameTooltip:Show()
end

local HookSetItemRef = SetItemRef
function SetItemRef(link, text, button)
	--local item, _, id = string.find(link, "item:(%d+):.*")
	--HookSetItemRef(link, text, button)
	--if not IsAltKeyDown() and not IsShiftKeyDown() and not IsControlKeyDown() and item then
	--AddVendorPrices(ItemRefTooltip, tonumber(id), 1)
	--end

	HookSetItemRef(link, text, button)
	--AddMoneyFrame(link, 1)
	if not link then
		ItemRefTooltip:AddLine("|nError!", 1, 0.13, 0.13)
	else
		local _, _, itemId = string.find(link, "item:(%d+)")
		if itemId then
			itemId = tonumber(itemId)
			if ItemDB[itemId] then
				if ItemDB[itemId] > 0 then
					ItemRefTooltip:AddLine("|n")
					SetTooltipMoney(ItemRefTooltip, ItemDB[itemId])
				else
					ItemRefTooltip:AddLine("|nNo sell price", 1, 1, 1)
				end
			else
				ItemRefTooltip:AddLine("|nItem ID: " .. itemId, 1, 1, 1)
			end
		end
	end
	ItemRefTooltip:Show()
end

local HookSetBagItem = GameTooltip.SetBagItem
function GameTooltip.SetBagItem(self, bag, slot)
	HookSetBagItem(self, bag, slot)

	local itemLink = GetContainerItemLink(bag, slot)
	local _, itemCount = GetContainerItemInfo(bag, slot)
	if itemLink then
		AddMoneyFrame(itemLink, itemCount)
	end
end

local HookSetQuestLogItem = GameTooltip.SetQuestLogItem
function GameTooltip.SetQuestLogItem(self, type, index)
	HookSetQuestLogItem(self, type, index)

	local GetQuestLogItemInfo
	if type == 'choice' then
		GetQuestLogItemInfo = GetQuestLogChoiceInfo
	elseif type == 'reward' then
		GetQuestLogItemInfo = GetQuestLogRewardInfo
	else
		-- 'required'
	end

	local itemLink = GetQuestLogItemLink(type, index)
	local itemName, _, itemCount = GetQuestLogItemInfo(index)
	DEFAULT_CHAT_FRAME:AddMessage(itemName .. ' - ' .. itemCount .. ' шт.')
	AddMoneyFrame(itemLink, itemCount)
end

local HookSetQuestItem = GameTooltip.SetQuestItem
function GameTooltip.SetQuestItem(self, type, index)
	HookSetQuestItem(self, type, index)

	local itemLink = GetQuestItemLink(type, index)
	local itemName, _, itemCount = GetQuestItemInfo(type, index)
	DEFAULT_CHAT_FRAME:AddMessage(itemName .. ' - ' .. itemCount .. ' шт.')
	AddMoneyFrame(itemLink, itemCount)
end

local HookSetLootItem = GameTooltip.SetLootItem
function GameTooltip.SetLootItem(self, slot)
	--GameTooltip.itemLink = GetLootSlotLink(slot)
	HookSetLootItem(self, slot)

	local itemLink = GetLootSlotLink(slot)
	local _, _, itemCount = GetLootSlotInfo(slot)
	AddMoneyFrame(itemLink, itemCount)
end
